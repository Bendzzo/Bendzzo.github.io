<!DOCTYPE html>
<html lang="sk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Anat√≥mia - Full Verzia s Navig√°ciou</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f0f2f5;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            user-select: text;
        }

        /* --- HLAVN√â MENU --- */
        .menu-container {
            text-align: center;
            background: white;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            max-width: 700px;
            width: 95%;
            margin-top: 30px;
        }
        
        .menu-title { color: #2c3e50; margin-bottom: 10px; font-size: 2rem; }
        .menu-subtitle { color: #7f8c8d; margin-bottom: 30px; font-size: 1rem; }

        .btn-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }

        .menu-btn {
            display: block;
            width: 100%;
            padding: 15px;
            font-size: 1.1rem;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: transform 0.2s, background 0.2s;
            font-weight: bold;
            color: white;
            text-align: center;
        }

        .btn-lat-sk { background-color: #3498db; }
        .btn-sk-lat { background-color: #9b59b6; }
        .btn-def { background-color: #e67e22; }
        .btn-exam { 
            background-color: #c0392b; 
            grid-column: span 2; 
            font-size: 1.3rem;
            padding: 20px;
            border-bottom: 4px solid #a93226;
        }
        
        .menu-btn:hover { transform: translateY(-3px); opacity: 0.9; }
        .menu-btn:active { transform: scale(0.98); }

        /* --- HERN√Å PLOCHA --- */
        .game-area {
            display: none;
            flex-direction: column;
            align-items: center;
            width: 100%;
        }

        .mode-badge {
            margin-bottom: 15px;
            background: #e1e1e1;
            padding: 5px 15px;
            border-radius: 15px;
            font-size: 0.9rem;
            color: #555;
            font-weight: bold;
        }

        /* --- NAVIGAƒåN√Å MRIE≈ΩKA (GRID) --- */
        .nav-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            justify-content: center;
            margin-bottom: 20px;
            max-width: 800px;
            padding: 10px;
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        .nav-item {
            width: 30px;
            height: 30px;
            border: 1px solid #d1d5db;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: 600;
            color: #555;
            transition: all 0.2s;
        }

        .nav-item:hover {
            transform: translateY(-2px);
            border-color: #3498db;
        }

        /* Akt√≠vna ot√°zka (pr√°ve zobrazen√°) */
        .nav-item.active {
            border: 2px solid #2c3e50;
            transform: scale(1.15);
            z-index: 10;
            box-shadow: 0 0 5px rgba(0,0,0,0.3);
        }

        /* Stavy */
        .nav-item.correct {
            background-color: #2ecc71;
            color: white;
            border-color: #27ae60;
        }

        .nav-item.incorrect {
            background-color: #e74c3c;
            color: white;
            border-color: #c0392b;
        }

        /* --- ≈†TATISTIKY --- */
        .stats {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
            font-size: 1.2rem;
            background: white;
            padding: 10px 30px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .stat-box { display: flex; flex-direction: column; align-items: center; font-weight: bold; }
        .stat-label { font-size: 0.8rem; color: #777; font-weight: normal; }
        .remaining { color: #3498db; }
        .correct { color: #2ecc71; }
        .incorrect { color: #e74c3c; }

        /* --- KARTA --- */
        .card-container {
            perspective: 1000px;
            width: 700px;
            max-width: 95%;
            height: 450px;
            position: relative;
            margin-bottom: 30px;
        }

        .card {
            width: 100%;
            height: 100%;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.5s;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            border-radius: 15px;
            background-color: white;
        }

        .card.flipped { transform: rotateY(180deg); }

        .card-face {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 30px;
            box-sizing: border-box;
            text-align: center;
            overflow-y: auto;
        }

        .card-front { background-color: #fff; color: #2c3e50; }
        .card-back { background-color: #fdfdfd; color: #2c3e50; transform: rotateY(180deg); border: 2px solid #e0e0e0; }

        h3 { color: #95a5a6; margin-top: 0; margin-bottom: 20px; font-size: 0.9rem; text-transform: uppercase; letter-spacing: 1px;}
        
        .card-content { font-size: 1.8rem; font-weight: bold; line-height: 1.4; }
        .card-sub { font-size: 1rem; color: #7f8c8d; margin-top: 10px; font-weight: normal; }
        
        .def-text {
            font-size: 1.3rem;
            font-weight: normal;
            font-style: italic;
            color: #444;
            line-height: 1.5;
            text-align: center;
        }

        .controls {
            display: flex;
            gap: 20px;
            justify-content: center;
        }

        .btn-control {
            padding: 15px 40px;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.1s;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            color: white;
            display: none; /* Skryt√© k√Ωm sa karta neotoƒç√≠ */
        }
        .btn-control:active { transform: scale(0.96); }
        .btn-correct { background-color: #2ecc71; }
        .btn-incorrect { background-color: #e74c3c; }

        .btn-menu {
            display: inline-block; 
            background: #7f8c8d; 
            color:white; 
            margin-top:30px; 
            padding: 15px 30px; 
            border:none; 
            border-radius:8px; 
            font-size:1.1rem; 
            cursor:pointer;
        }

        /* --- SIDEBAR (ZOZNAM) --- */
        .hamburger-btn {
            position: fixed;
            top: 15px;
            left: 20px;
            z-index: 2000;
            background: #2c3e50;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            transition: background 0.3s;
        }
        .hamburger-btn:hover { background: #34495e; }

        .sidebar {
            position: fixed;
            top: 0;
            left: 0;
            width: 320px;
            height: 100vh;
            background: white;
            z-index: 1999;
            box-shadow: 2px 0 15px rgba(0,0,0,0.2);
            transform: translateX(-100%);
            transition: transform 0.3s ease-in-out;
            overflow-y: auto;
            padding-top: 70px; 
            padding-bottom: 30px;
        }

        .sidebar.active { transform: translateX(0); }

        .sidebar-category {
            background: #f0f2f5;
            padding: 10px 20px;
            font-weight: bold;
            color: #2c3e50;
            border-bottom: 1px solid #ddd;
            font-size: 0.95rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-top: 5px;
        }

        .sidebar-item {
            display: block;
            padding: 10px 20px;
            color: #555;
            text-decoration: none;
            border-bottom: 1px solid #eee;
            font-size: 0.9rem;
            cursor: pointer;
            transition: background 0.2s, padding-left 0.2s;
        }

        .sidebar-item:hover {
            background: #eef2f7;
            padding-left: 25px;
            color: #3498db;
        }
        
        .sidebar-latin { font-weight: bold; display: block; }
        .sidebar-def { font-size: 0.8rem; color: #e67e22; display: block; margin-top: 2px; font-style: italic;}

        /* --- MODAL WINDOW --- */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            z-index: 3000;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(3px);
        }

        .modal-content {
            background: white;
            width: 90%;
            max-width: 600px;
            border-radius: 15px;
            padding: 30px;
            position: relative;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            text-align: left;
        }

        .modal-close {
            position: absolute;
            top: 10px;
            right: 15px;
            background: none;
            border: none;
            font-size: 2rem;
            color: #aaa;
            cursor: pointer;
        }
        .modal-close:hover { color: #e74c3c; }

        .modal-row { margin-bottom: 20px; }
        .modal-label { font-size: 0.8rem; color: #7f8c8d; text-transform: uppercase; margin-bottom: 5px;}
        .modal-text { font-size: 1.2rem; font-weight: bold; color: #2c3e50; }
        .modal-def { font-style: italic; color: #555; background: #f9f9f9; padding: 10px; border-left: 4px solid #3498db;}
    </style>
</head>
<body>

    <!-- SIDEBAR -->
    <button class="hamburger-btn" onclick="toggleSidebar()">‚ò∞ Zoznam</button>
    <div class="sidebar" id="sidebar"></div>

    <!-- MODAL -->
    <div class="modal-overlay" id="modal-overlay" onclick="closeModal(event)">
        <div class="modal-content" onclick="event.stopPropagation()">
            <button class="modal-close" onclick="closeModalDirect()">√ó</button>
            <h2 style="margin-top:0; color:#3498db;">Detail pojmu</h2>
            <div class="modal-row">
                <div class="modal-label">Latinsky</div>
                <div class="modal-text" id="modal-lat"></div>
            </div>
            <div class="modal-row">
                <div class="modal-label">Slovensky</div>
                <div class="modal-text" id="modal-sk"></div>
            </div>
            <div class="modal-row" id="modal-def-row">
                <div class="modal-label">Defin√≠cia</div>
                <div class="modal-text modal-def" id="modal-def"></div>
            </div>
        </div>
    </div>

    <!-- MENU -->
    <div class="menu-container" id="main-menu">
        <h1 class="menu-title">Anat√≥mia</h1>
        <div class="menu-subtitle">Z√°klady teoretickej medic√≠ny (ZS 2025/2026)</div>
        
        <div class="btn-group">
            <button class="menu-btn btn-lat-sk" onclick="startGame('LAT_SK')">
                üáÆüáπ ‚û°Ô∏è üá∏üá∞ Lat -> Slo
            </button>
            <button class="menu-btn btn-sk-lat" onclick="startGame('SK_LAT')">
                üá∏üá∞ ‚û°Ô∏è üáÆüáπ Slo -> Lat
            </button>
            <button class="menu-btn btn-def" onclick="startGame('DEF_SK')">
                üìñ ‚û°Ô∏è üá∏üá∞ Definuj: [Slovensk√© slovo]
            </button>
            <button class="menu-btn btn-def" onclick="startGame('LAT_DEF')">
                üìñ ‚û°Ô∏è üáÆüáπ Definuj: [Latinsk√© slovo]
            </button>
        </div>
        
        <button class="menu-btn btn-exam" onclick="startGame('EXAM')">
            üéì SK√ö≈†KA (40 n√°hodn√Ωch)<br>
            <span style="font-size:0.8rem; font-weight:normal;">Vid√≠≈° defin√≠ciu ‚û°Ô∏è Uh√°dni latinsk√Ω n√°zov</span>
        </button>
    </div>

    <!-- HRA -->
    <div class="game-area" id="game-area">
        <div class="mode-badge" id="mode-indicator"></div>
        
        <!-- TU JE T√Å VR√ÅTEN√Å MRIE≈ΩKA -->
        <div class="nav-grid" id="nav-grid"></div>

        <div class="stats">
            <div class="stat-box">
                <span class="stat-value remaining" id="count-remaining">0</span>
                <span class="stat-label">Spolu</span>
            </div>
            <div class="stat-box">
                <span class="stat-value correct" id="count-correct">0</span>
                <span class="stat-label">Spr√°vne</span>
            </div>
            <div class="stat-box">
                <span class="stat-value incorrect" id="count-incorrect">0</span>
                <span class="stat-label">Chyby</span>
            </div>
        </div>

        <div class="card-container" id="card-container">
            <div class="card" id="flashcard">
                <div class="card-face card-front">
                    <h3 id="lbl-question">Ot√°zka</h3>
                    <div id="q-content"></div>
                </div>
                <div class="card-face card-back">
                    <h3 id="lbl-answer">Odpoveƒè</h3>
                    <div id="a-content"></div>
                </div>
            </div>
        </div>

        <div class="controls" id="controls">
            <button id="btn-incorrect" class="btn-control btn-incorrect" onclick="handleAnswer(false)">Nespr√°vne</button>
            <button id="btn-correct" class="btn-control btn-correct" onclick="handleAnswer(true)">Spr√°vne</button>
        </div>
    </div>

    <script>
        // --- DATA ---
        const dictionary = [
            // Z√°kladn√© pojmy
            { lat: "anat√≥mia", sk: "anat√≥mia", def: "Je vedeck√Ω odbor, ktor√Ω patr√≠ do veƒækej skupiny morfologick√Ωch vied... ≈†tuduje stavbu, ≈°trukt√∫ru a tvar ≈æiv√Ωch organizmov." },
            { lat: "cellula", sk: "bunka", def: "Je najmen≈°√≠ ≈æiv√Ω √∫tvar, ktor√Ω je schopn√Ω samostatnej existencie." },
            { lat: "textus", sk: "tkanivo", def: "je s√∫bor tvarovo podobn√Ωch, ale funkƒçne diferencovan√Ωch buniek" },
            // Bunka a organely
            { lat: "mitochondria", sk: "mitochondria", def: "organely nevyhnutn√© pre ≈æivot eukaryotick√Ωch buniek, predstavuj√∫ energetick√© centrum bunky." },
            { lat: "ribos√≥m", sk: "riboz√≥m", def: "najmen≈°ie bunkov√© organely nevyhnutn√© na tvorbu bielkov√≠n." },
            { lat: "nucleus", sk: "jadro", def: "jadro oddelen√© od cytoplazmy jadrovou membr√°nou" },
            { lat: "lysosoma", sk: "lyzoz√≥m", def: "jednomembr√°nov√© organely, v ktor√Ωch prebieha tzv. bunkov√© tr√°venie." },
            { lat: "centriolum", sk: "centriola", def: "≈°trukt√∫ra nach√°dzaj√∫ca sa v bl√≠zkosti jadra; miesto vyrastania a tvorby mikrotubulov v cytoplazme." },
            // Tkaniv√°
            { lat: "epithelium", sk: "epitel", def: "tvoria ho veƒæmi podobn√© bunky usporiadan√© tesne vedƒæa seba a medzi nimi je len veƒæmi m√°lo medzibunkovej hmoty" },
            { lat: "tela fibrosa", sk: "v√§zivo", def: "podporn√Ω typ tkaniva... zv√§ƒç≈°a m√§kk√© a poddajn√© tkanivo, tvor√≠ v√Ωpl≈à medzi org√°nmi a podko≈æn√Ωm tukom" },
            { lat: "cartilago", sk: "chrupka", def: "bezcievne podporn√© spojivov√© tkanivo odoln√© proti tlaku, je pru≈æn√©, tuh√© a pevn√©" },
            { lat: "os", sk: "kos≈•", def: "Tvor√≠ je podporn√© spojivov√© tkanivo ‚Äì kostn√© tkanivo" },
            // Kostrov√° s√∫stava
            { lat: "periosteum", sk: "okostnica", def: "je pevn√° v√§zivov√° blana." },
            { lat: "medulla ossium", sk: "kostn√° dre≈à", def: "vypƒ∫≈àa dutiny kost√≠." },
            { lat: "articulatio", sk: "kƒ∫b", def: "je pohybliv√© spojenie dvoch alebo viacer√Ωch kost√≠, ktor√© sa dot√Ωkaj√∫ kƒ∫bov√Ωmi plochami pokryt√Ωmi chrupkou." },
            { lat: "columna vertebralis", sk: "chrbtica", def: "Z√°kladn√∫ os trupu tvor√≠ CHRBTICA" },
            { lat: "vertebra", sk: "stavec", def: "Chrbtica = 33 a≈æ 34 stavcov" },
            { lat: "thorax", sk: "hrudn√≠k", def: "ohraniƒçuje hrudn√≠kov√∫ dutinu, v ktorej je ulo≈æen√© srdce, pƒæ√∫ca a veƒæk√© cievy" },
            { lat: "costa", sk: "rebro", def: "s√∫ dlh√©, ploch√© a obl√∫kovit√© ohnut√© kosti" },
            // Svalov√° s√∫stava
            { lat: "musculus", sk: "sval", def: "Je ≈°trukt√∫ra, v ktorej v d√¥sledku ≈°√≠renia vzruchu z nervov√©ho tkaniva vznik√°... mechanick√° odpoveƒè vo forme svalovej kontrakcie" },
            { lat: "tendo", sk: "≈°ƒæacha", def: "priame, alebo nepriame pripojenie svalu ku kosti, na chrupku, alebo do ko≈æe" },
            { lat: "diaphragma", sk: "br√°nica", def: "hlavn√Ω a najd√¥le≈æitej≈°√≠ d√Ωchac√≠ sval; ploch√Ω sval. Oddeƒæuje hrudn√≠kov√∫ a bru≈°n√∫ dutinu." },
            // Nervov√° s√∫stava
            { lat: "neur√≥n", sk: "nervov√° bunka", def: "Z√°kladn√° funkƒçn√° a vykon√°vacia jednotka NS je nervov√° bunka" },
            { lat: "dendrit", sk: "dendrit", def: "kr√°tke, bohato sa vetviace nervov√© v√Ωbe≈æky, ≈°pecializovan√© na pr√≠jem sign√°lov" },
            { lat: "ax√≥n", sk: "neurit", def: "zvyƒçajne najdlh≈°√≠ v√Ωbe≈æok neur√≥nu, dlh√© osov√© vl√°kno, ktor√Ωm sa pren√°≈°a impulzy do in√Ωch buniek alebo tkan√≠v" },
            { lat: "synapsia", sk: "synapsia", def: "Nervov√© spojenie medzi jednotliv√Ωmi neur√≥nmi alebo neur√≥nmi a efektorov√Ωmi bunkami" },
            { lat: "encephalon", sk: "mozog", def: "≈°trukt√∫ra centr√°lneho nervov√©ho syst√©mu (CNS) ulo≈æen√° v lebeƒçnej dutine, ktor√° ho ochra≈àuje" },
            { lat: "medulla spinalis", sk: "miecha", def: "je 45 cm dlh√° ≈°trukt√∫ra, hrub√° 1 a≈æ 1,5 cm s hmotnos≈•ou asi 35 g, ktor√° sl√∫≈æi ako spojovac√≠ ƒçl√°nok medzi mozgom a ostatn√Ωmi org√°nmi v tele ƒçloveka" },
            { lat: "meninges", sk: "mozgov√© pleny", def: "Centr√°lny nervov√Ω syst√©m je uzavret√Ω syst√©m, ktor√Ω m√° na svojom povrchu 3 s√∫visl√© vrstvy v√§zivov√Ωch obalov, ktor√© sa naz√Ωvaj√∫ pleny" },
            { lat: "mesencephalon", sk: "stredn√Ω mozog", def: "Je najmen≈°√≠m oddielom mozgu" },
            { lat: "cerebellum", sk: "mozoƒçek", def: "Je ≈°trukt√∫ra ulo≈æen√° nad predƒ∫≈æenou miechou a Varolov√Ωm mostom." },
            { lat: "diencephalon", sk: "medzimozog", def: "Je tvoren√Ω ≈°trukt√∫rami, ktor√© sa nach√°dzaj√∫ v okol√≠ III. mozgovej komory." },
            { lat: "thalamus", sk: "l√¥≈æko", def: "Je p√°rov√° asi 4 cm dlh√° ov√°lna vyv√Ω≈°enina vajcovit√©ho tvaru." },
            { lat: "hypothalamus", sk: "podl√¥≈æko", def: "Je ≈°trukt√∫ra tvoren√° prednou stenou medzimozgu a nach√°dza na spodine III. mozgovej komory." },
            { lat: "telencephalon", sk: "koncov√Ω mozog", def: "je najobjemnej≈°ou ƒças≈•ou mozgu a naz√Ωva sa niekedy aj veƒæk√Ω mozog." },
            // Zmysly
            { lat: "organum visus", sk: "zrakov√Ω org√°n - oƒçi", def: "predstavuj√∫ org√°n, ktor√Ω prij√≠ma sveteln√© stimuly z vonkaj≈°√≠ch zdrojov a pretv√°ra ich na nervov√© sign√°ly" },
            { lat: "cornea", sk: "oƒçn√° rohovka", def: "tvor√≠ ju priezraƒçn√Ω disk, cez ktor√Ω prech√°dzaj√∫ sveteln√© l√∫ƒçe dovn√∫tra oƒçnej gule" },
            { lat: "sclera", sk: "oƒçn√© bielko", def: "siln√Ω, nepriesvitn√Ω vonkaj≈°√≠ mlieƒçne sfarben√Ω kryt oƒçnej gule" },
            { lat: "iris", sk: "d√∫hovka", def: "je pigmentov√Ω disk s otvorom v strede" },
            { lat: "retina", sk: "sietnica", def: "nach√°dzaj√∫ sa v nej bunky citliv√© na svetlo (fotoreceptory), ktor√© zodpovedaj√∫ za premenu sveteln√Ωch impulzov na nervov√©" },
            { lat: "lens", sk: "≈°o≈°ovka", def: "je priezraƒçn√Ω, elastick√Ω, konvexn√Ω √∫tvar, ktor√Ω s√∫streƒèuje sveteln√© l√∫ƒçe na sietnicu" },
            { lat: "corpus vitreum", sk: "sklovec", def: "je r√¥solovit√° priezraƒçn√° hmota, ktor√° vypƒ∫≈àa v√§ƒç≈°inu priestoru oƒçnej gule a tak jej umo≈æ≈àuje udr≈æa≈• svoj tvar" },
            { lat: "auris externa", sk: "vonkaj≈°ie ucho", def: "sa sklad√° z u≈°nice a vonkaj≈°ieho zvukovodu, ktor√Ω je zakonƒçen√Ω u≈°n√Ωm bubienkom." },
            { lat: "auris media", sk: "stredn√© ucho", def: "je ulo≈æen√© v dutine sp√°nkovej kosti nazvanej bubienkov√° dutina" },
            // Srdce a cievy
            { lat: "cor", sk: "srdce", def: "je nep√°rov√Ω dut√Ω svalov√Ω org√°n ƒçervenohnedej farby" },
            { lat: "pericardium", sk: "osrdcovn√≠k", def: "Je pevn√Ω v√§zivov√Ω vak, v ktorom je ulo≈æen√© srdce" },
            { lat: "epicardium", sk: "osrdie", def: "Je tenk√° hladk√° a mokvav√° blana, ktor√° pokr√Ωva povrch srdca." },
            { lat: "myocardium", sk: "srdcov√Ω sval - myokard", def: "Je ≈°peci√°lny typ prieƒçne pruhovan√©ho svalu tvoriaci vzru≈°iv√Ω a prevodov√Ω srdcov√Ω org√°n." },
            { lat: "endocardium", sk: "vn√∫torn√© osrdie - endokard", def: "Je hladk√°, leskl√° a priesvitn√° blana tvoriaca vn√∫torn√∫ stenu srdca a vystielaj√∫ca srdcov√© dutiny." },
            { lat: "vasa sanguinea", sk: "krvn√© cievy", def: "predstavuj√∫ syst√©m trub√≠c, v ktor√Ωch pr√∫di krv v celom tele" },
            { lat: "arteria", sk: "tepna", def: "s√∫ v≈°etky cievy, ktor√© transportuj√∫ okysliƒçen√∫ krv zo srdca do tkan√≠v a org√°nov." },
            { lat: "vena", sk: "≈æila", def: "s√∫ v≈°etky cievy, ktor√© transportuj√∫ odkysliƒçen√∫ krv z tkan√≠v a org√°nov do srdca s v√Ωnimkou pƒæ√∫cnej ≈æily" },
            { lat: "capillare", sk: "vl√°soƒçnica", def: "s√∫ tenkostenn√© a jemn√© cievy, ktor√© tvoria zlo≈æit√© siete, ktor√Ωch √∫lohou je v√Ωmena krvn√Ωch plynov a in√Ωch l√°tok medzi krvou a tkanivami." },
            { lat: "aorta", sk: "srdcovnica", def: "Najmohutnej≈°ou tepnou cel√©ho obehov√©ho syst√©mu je srdcovnica" },
            { lat: "sanguis", sk: "krv", def: "je r√¥znorod√°, ≈æivotne d√¥le≈æit√° nepriehƒæadn√°, extracelul√°rna tekutina cirkuluj√∫ca v krvn√Ωch cievach" },
            { lat: "erytrocyt", sk: "ƒçerven√° krvinka", def: "s√∫ diskovit√©, vysoko diferencovan√© krvn√© elementy, ktor√© poƒças v√Ωvoja v priebehu dozrievania str√°caj√∫ bunkov√© jadro" },
            { lat: "leukocyt", sk: "biela krvinka", def: "s√∫ bezfarebn√© bunky s jadrom, ktor√© vznikaj√∫ v kostnej dreni, slezine a lymfoidnom tkanive, mandliach a t√Ωmuse" },
            { lat: "trombocyt", sk: "krvn√° do≈°tiƒçka", def: "s√∫ najmen≈°ie telieska, bezfarebn√© a bezjadrov√© √∫lomky cytoplazmy veƒæk√Ωch buniek" },
            // D√Ωchacia s√∫stava
            { lat: "nasus", sk: "nos", def: "M√° tvar trojstrannej pyram√≠dy, ktor√° konƒç√≠ kore≈àom nosa v najvy≈°≈°om bode" },
            { lat: "pharynx", sk: "hltan", def: "je lievikovito roz≈°√≠ren√° svalov√° ƒças≈• tr√°viacej r√∫ry, ktor√° je dlh√° asi 12 ‚Äì 14 cm." },
            { lat: "larynx", sk: "hrtan", def: "Je zaƒçiatoƒçn√Ω org√°n doln√Ωch d√Ωchac√≠ch ciest ulo≈æen√Ω v prednej ƒçasti krku pred hltanom, a z√°rove≈à je to org√°n hlasu" },
            { lat: "trachea", sk: "priedu≈°nica", def: "je ohybn√° trubica nadv√§zuj√∫ca na prstienkovit√∫ chrupavku hrtana, ktor√° je ulo≈æen√° pred pa≈æer√°kom" },
            { lat: "bronchi", sk: "priedu≈°ky", def: "s√∫ priamym pokraƒçovan√≠m priedu≈°nice, ktor√° sa rozvetvuje na dve priedu≈°ky" },
            { lat: "pulmo", sk: "pƒæ√∫ca", def: "s√∫ p√°rov√Ω org√°n ku≈æeƒæovit√©ho tvaru, ktor√Ω je ulo≈æen√Ω v hrudnom ko≈°i a vypƒ∫≈àa preva≈æn√∫ ƒças≈• hrudn√≠kovej dutiny" },
            { lat: "alveolus", sk: "pƒæ√∫cny mech√∫rik", def: "s√∫ najjemnej≈°ie mech√∫rikovit√© zakonƒçenia priedu≈°iek v pƒæ√∫cach, tvoren√© kom√¥rkami, steny ktor√Ωch s√∫ pretkan√© sie≈•ou krvn√Ωch vl√°soƒçn√≠c ‚Äì kapil√°r" },
            // Moƒçov√° s√∫stava
            { lat: "renes", sk: "obliƒçky", def: "s√∫ p√°rov√Ω hnedoƒçerven√Ω org√°n zlo≈æen√Ω s pravej a ƒæavej obliƒçky" },
            { lat: "nefr√≥n", sk: "nefr√≥n", def: "Je z√°kladn√° stavebn√° a funkƒçn√° jednotka obliƒçky, ktor√° m√° od 3 do 10 cm a sklad√° sa z dvoch ƒçast√≠: telieska a kan√°likov" },
            { lat: "ureter", sk: "moƒçovod", def: "Je p√°rov√° 20 a≈æ 30 cm dlh√° trubica z hladkej svaloviny s priemerom 5 a≈æ 7 mm a pokryt√° v√§zivov√Ωm obalom" },
            { lat: "vesica urinaria", sk: "moƒçov√Ω mech√∫r", def: "Je dut√Ω, roztiahnuteƒæn√Ω svalov√Ω org√°n o objeme pribli≈æne 500 ml, ktor√Ω je ulo≈æen√Ω za lonovou sponou a sl√∫≈æi ako rezervo√°r moƒçu" },
            { lat: "urethra", sk: "moƒçov√° r√∫ra", def: "je trubica, ktor√° vystupuje z dna moƒçov√©ho mech√∫ra." },
            // Tr√°viaca s√∫stava
            { lat: "oesophagus", sk: "pa≈æer√°k", def: "je okolo 25 cm dlh√° a asi s 1,5 cm v priemere svalov√° trubica... Je to prv√° ƒças≈• vlastnej tr√°viacej r√∫ry, ktor√° sp√°ja hltan so ≈æal√∫dkom." },
            { lat: "gaster", sk: "≈æal√∫dok", def: "Je dut√Ω svalov√Ω org√°n v tvare zahnut√©ho vaku s objemom okolo 1,5 litra, le≈æiaci v hornej ƒçasti bru≈°nej dutiny pod br√°niƒçnou klenbou." },
            { lat: "intestinum tenue", sk: "tenk√© ƒçrevo", def: "Je 4 a≈æ 5 m dlh√° a 3 a≈æ 3,5 cm ≈°irok√° svalov√° trubica... ktor√° je mnohon√°sobne popreh√Ωban√° a stoƒçen√° svalov√° r√∫ra sp√°jaj√∫ca ≈æal√∫dok s hrub√Ωm ƒçrevom." },
            { lat: "duodenum", sk: "dvan√°stnik", def: "je pribli≈æne 30 cm dlh√°, m√°lo pohybliv√° ƒças≈• v tvare podkovy, ktor√° je ulo≈æen√° pod ≈æal√∫dkom" },
            { lat: "jejunum", sk: "laƒçn√≠k", def: "Je asi 120 cm dlh√° ƒças≈• ƒçreva, ktorej n√°zov je odvoden√Ω od toho, ≈æe pri pitve b√Ωva pr√°zdny" },
            { lat: "ileum", sk: "bedrovn√≠k", def: "je najkrat≈°ou ƒças≈•ou tenk√©ho ƒçreva, ktor√° vy√∫s≈•uje v pravej bedrovej jame do hrub√©ho ƒçreva" },
            { lat: "intestinum crassum", sk: "hrub√© ƒçrevo", def: "Je 150 cm a 5 a≈æ 8 cm dlh√° ƒças≈• ƒçreva, ktor√° sa zaƒç√≠na v pravej bedrovej jame vakovitou slepou, roz≈°√≠renou ƒças≈•ou - slep√Ωm ƒçrevom" },
            { lat: "caecum", sk: "slep√© ƒçrevo", def: "Je asi 7 cm dlh√° ƒças≈• hrub√©ho ƒçreva, do ktorej z bedrovn√≠ka sklzne natr√°ven√° potrava." },
            { lat: "rectum", sk: "koneƒçn√≠k", def: "pokraƒçuje do malej panvy ako esovit√° kƒæuƒçka... konƒç√≠ an√°lnym otvorom" },
            { lat: "hepar", sk: "peƒçe≈à", def: "Je hnedoƒçerven√Ω hladk√Ω, pevn√Ω, pru≈æn√Ω a z√°rove≈à krehk√Ω (parenchymatick√Ω) org√°n... Je najv√§ƒç≈°ou ≈æƒæazou ƒæudsk√©ho tela." },
            { lat: "vesica biliaris", sk: "≈ælƒçn√≠k", def: "Je svalov√Ω vakovit√Ω org√°n hru≈°kovit√©ho tvaru... Je z√°sob√°r≈àou ≈ælƒçe" },
            { lat: "pancreas", sk: "pod≈æal√∫dkov√° ≈æƒæaza", def: "Je org√°n ulo≈æen√Ω na ƒæavej strane, pod ≈æal√∫dkom a ƒçiastoƒçne za n√≠m, prieƒçne od ohybu dvan√°stnika po slezinu." },
            // Endokrinn√Ω syst√©m
            { lat: "hypophysis", sk: "podmozgov√° ≈æƒæaza", def: "je mal√° ≈æƒæaza fazuƒæovit√©ho tvaru veƒækosti 1 cm, umiestnen√° je v spodine lebeƒçnej a je spojen√° s hypotalamom stopkou." },
            { lat: "glandula pinealis", sk: "≈°u≈°kovit√© teliesko - epif√Ωza", def: "Je asi 1 cm dlh√Ω v√Ωrastok medzimozgu." },
            { lat: "glandula thyroidea", sk: "≈°t√≠tna ≈æƒæaza", def: "Je ≈æƒæaza zlo≈æen√° z dvoch lalokov spojen√Ωch most√≠kom, ulo≈æen√° na prednej strane priedu≈°nice pod ≈°t√≠tnou chrupkou." },
            { lat: "glandulae parathyroideae", sk: "pri≈°t√≠tne ≈æƒæazy", def: "S√∫ to dva p√°ry ≈æƒæazov√Ωch (epitelov√Ωch) teliesok v tvare hr√°≈°ku umiestnen√Ωch na zadnej strane ≈°t√≠tnej ≈æƒæazy." },
            { lat: "glandulae suprarenales", sk: "nadobliƒçky", def: "s√∫ p√°rov√© endokrinn√© ≈æƒæazy, ulo≈æen√© na horn√Ωch p√≥loch oboch obliƒçiek." },
            { lat: "placenta", sk: "placenta", def: "Je plodov√Ω kol√°ƒç s hmotnos≈•ou cca 0,5 kg a sl√∫≈æi z√°rove≈à ako endokrinn√° ≈æƒæaza" },
            // Lymfatick√Ω syst√©m
            { lat: "systema lymphaticum", sk: "miazgov√° s√∫stava", def: "Je syst√©m skladaj√∫ci sa z lymfatick√Ωch ciev (miazgovody) a ≈°pecializovan√Ωch lymfoidn√Ωch org√°nov a tkan√≠v" },
            { lat: "lymfa", sk: "miazga", def: "Je bezfarebn√Ω produkt tkanivov√©ho moku, ktor√Ω vznik√° odoberan√≠m metabolitov vznikaj√∫cich v bunk√°ch" },
            { lat: "nodi lymphatici", sk: "lymfatick√© uzliny", def: "mal√© √∫tvaru v tvare fazule, ktor√© sa vyskytuj√∫ jednotlivo alebo v skupin√°ch. Vznikaj√∫ v nich lymfocyty sl√∫≈æiace ako filter" },
            { lat: "lien", sk: "slezina", def: "org√°n bru≈°nej dutiny, ulo≈æen√Ω pod ƒæavou br√°nicou... svojou funkciou patr√≠ k cievnemu a lymfatick√©mu syst√©mu" },
            { lat: "thymus", sk: "detsk√° ≈æƒæaza", def: "Je p√°rov√Ωm lymfatick√Ωm org√°nom, dobre vyvinut√Ωm u novorodencov. Ulo≈æen√° je v hrudn√≠ku vpredu za hrudnou kos≈•ou" },
            // Ko≈æa
            { lat: "cutis", sk: "ko≈æa", def: "Je najv√§ƒç≈°√≠ plo≈°n√Ω org√°n ƒæudsk√©ho tela o ploche 1,5 a≈æ 1,8 m2 a hmotnosti asi 4,5 kg" },
            { lat: "epidermis", sk: "poko≈æka", def: "je vrchn√° vrstva ko≈æe, ktor√° je hrub√° od 0,07 do 0,4 mm." },
            { lat: "corium", sk: "zam≈°a", def: "je stredn√° vrstva ko≈æe le≈æiaca pod poko≈ækou, ktor√∫ vy≈æivuje a naz√Ωva sa aj ≈°k√°ra." },
            { lat: "subcutis", sk: "podko≈æn√© v√§zivo", def: "Je to najhlb≈°ia ƒças≈• ko≈æe, ktor√∫ tvor√≠ riedke v√§zivo s tukov√Ωmi bunkami" },
            { lat: "capillus", sk: "vlas", def: "tenk√©, dlh√©, zrohovaten√© valcovit√© √∫tvary, ktor√© prerastaj√∫ nad povrch ko≈æe" },
            { lat: "unguis", sk: "necht", def: "je zrohovaten√° vypukl√° platniƒçka na konci ƒçl√°nkov prstov na ruke a nohe." },
            // Dopl≈àuj√∫ce pojmy
            { lat: "abdomen", sk: "brucho" },
            { lat: "abduccia", sk: "odtiahnutie" },
            { lat: "adduccia", sk: "pritiahnutie" },
            { lat: "antebrachium", sk: "predlaktie" },
            { lat: "anus", sk: "an√°lny otvor" },
            { lat: "apex", sk: "hrot" },
            { lat: "caput", sk: "hlava" },
            { lat: "cervix", sk: "krk" },
            { lat: "clavicula", sk: "kƒæ√∫ƒçna kos≈•" },
            { lat: "coccyx", sk: "kostrƒç" },
            { lat: "collum", sk: "krk" },
            { lat: "cranium", sk: "lebka" },
            { lat: "cubitus", sk: "lake≈•" },
            { lat: "digitus", sk: "prst" },
            { lat: "dorsum", sk: "chrb√°t" },
            { lat: "femur", sk: "stehno" },
            { lat: "fibula", sk: "ihlica" },
            { lat: "flexia", sk: "ohnutie" },
            { lat: "genu", sk: "koleno" },
            { lat: "humerus", sk: "ramenn√° kos≈•" },
            { lat: "manus", sk: "ruka" },
            { lat: "maxilla", sk: "ƒçelus≈•" },
            { lat: "mandibula", sk: "s√°nka" },
            { lat: "mentum", sk: "brada" },
            { lat: "nasale", sk: "nosn√Ω" },
            { lat: "occipitalis", sk: "z√°hlavn√Ω" },
            { lat: "orbita", sk: "oƒçnica" },
            { lat: "ovaria", sk: "vajeƒçn√≠ky" },
            { lat: "palatum", sk: "podnebie" },
            { lat: "patella", sk: "jabƒ∫ƒçko" },
            { lat: "pelvis", sk: "panva" },
            { lat: "pes", sk: "noha" },
            { lat: "radius", sk: "vretenn√° kos≈•" },
            { lat: "scapula", sk: "lopatka" },
            { lat: "tarsus", sk: "priehlavok" },
            { lat: "tibia", sk: "p√≠≈°≈•ala" },
            { lat: "thorax", sk: "hrudn√≠k" },
            { lat: "ulna", sk: "lak≈•ov√° kos≈•" },
            { lat: "venter", sk: "brucho" },
            { lat: "vomer", sk: "ƒçerieslo" }
        ];

        // --- GAME STATE ---
        // deck obsahuje indexy do poƒæa dictionary
        let deck = []; 
        let currentMode = ''; 
        let currentDeckIndex = 0; // Kde sa nach√°dzame v decku
        
        // Uchov√°vame stav ka≈ædej karty v session: 'todo', 'correct', 'incorrect'
        let sessionState = [];

        let isFlipped = false;
        
        const cardElement = document.getElementById('flashcard');
        const qContentEl = document.getElementById('q-content');
        const aContentEl = document.getElementById('a-content');
        const lblQuestion = document.getElementById('lbl-question');
        const lblAnswer = document.getElementById('lbl-answer');
        const btnCor = document.getElementById('btn-correct');
        const btnInc = document.getElementById('btn-incorrect');
        const gridContainer = document.getElementById('nav-grid');
        
        // --- HELPERS ---
        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // --- SIDEBAR LOGIC ---
        function initSidebar() {
            const sidebar = document.getElementById('sidebar');
            let html = '';
            
            const sortedDict = [...dictionary].sort((a, b) => a.lat.localeCompare(b.lat));
            let currentLetter = '';
            
            sortedDict.forEach((item) => {
                const firstChar = item.lat.charAt(0).toUpperCase();
                if (firstChar !== currentLetter) {
                    currentLetter = firstChar;
                    html += `<div class="sidebar-category">${currentLetter}</div>`;
                }
                const originalIndex = dictionary.indexOf(item);
                html += `
                    <div class="sidebar-item" onclick="openModal(${originalIndex})">
                        <span class="sidebar-latin">${item.lat}</span>
                        ${item.def ? '<span class="sidebar-def">Obsahuje defin√≠ciu</span>' : ''}
                    </div>
                `;
            });
            sidebar.innerHTML = html;
        }

        function toggleSidebar() { document.getElementById('sidebar').classList.toggle('active'); }
        
        function openModal(index) {
            const item = dictionary[index];
            document.getElementById('modal-lat').textContent = item.lat;
            document.getElementById('modal-sk').textContent = item.sk;
            const defRow = document.getElementById('modal-def-row');
            if (item.def) {
                document.getElementById('modal-def').textContent = item.def;
                defRow.style.display = 'block';
            } else {
                defRow.style.display = 'none';
            }
            document.getElementById('modal-overlay').style.display = 'flex';
        }

        function closeModal(e) { if(e.target.id === 'modal-overlay') document.getElementById('modal-overlay').style.display = 'none'; }
        function closeModalDirect() { document.getElementById('modal-overlay').style.display = 'none'; }

        // --- GAME FUNCTIONS ---

        function startGame(mode) {
            currentMode = mode;
            currentDeckIndex = 0;
            
            let sourceIndices = [];
            
            // Filtrovanie
            if (mode === 'EXAM') {
                const defIndices = dictionary.map((item, i) => item.def ? i : -1).filter(i => i !== -1);
                shuffle(defIndices);
                sourceIndices = defIndices.slice(0, 40);
            } else if (mode === 'DEF_SK' || mode === 'LAT_DEF') {
                sourceIndices = dictionary.map((item, i) => item.def ? i : -1).filter(i => i !== -1);
                shuffle(sourceIndices);
            } else {
                sourceIndices = dictionary.map((_, i) => i);
                shuffle(sourceIndices);
            }

            deck = sourceIndices;
            
            // Inicializ√°cia stavov pre mrie≈æku
            sessionState = deck.map(() => 'todo');

            // UI
            document.getElementById('main-menu').style.display = 'none';
            document.getElementById('game-area').style.display = 'flex';
            document.getElementById('nav-grid').style.display = 'flex'; // Zobrazi≈• mrie≈æku
            
            // Update nadpis
            let modeText = "";
            switch(mode) {
                case 'LAT_SK': modeText = "Latinsko ‚Æï Slovensk√Ω"; break;
                case 'SK_LAT': modeText = "Slovensko ‚Æï Latinsk√Ω"; break;
                case 'DEF_SK': modeText = "Defin√≠cia: ƒåo je [Slovensky]?"; break;
                case 'LAT_DEF': modeText = "Latinsko ‚Æï Defin√≠cia"; break;
                case 'EXAM': modeText = "SK√ö≈†KA: Defin√≠cia ‚Æï Latinsky"; break;
            }
            document.getElementById('mode-indicator').textContent = modeText;

            renderGrid();
            loadCard(0);
        }

        function renderGrid() {
            gridContainer.innerHTML = '';
            deck.forEach((_, index) => {
                const btn = document.createElement('div');
                btn.className = 'nav-item';
                btn.textContent = index + 1;
                btn.onclick = () => jumpToQuestion(index);
                btn.id = `nav-item-${index}`;
                gridContainer.appendChild(btn);
            });
            updateGrid();
        }

        function updateGrid() {
            sessionState.forEach((state, i) => {
                const btn = document.getElementById(`nav-item-${i}`);
                if (state === 'correct') {
                    btn.classList.add('correct');
                    btn.classList.remove('incorrect');
                } else if (state === 'incorrect') {
                    btn.classList.add('incorrect');
                    btn.classList.remove('correct');
                } else {
                    btn.classList.remove('correct', 'incorrect');
                }
                
                if (i === currentDeckIndex) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });
        }

        function jumpToQuestion(index) {
            loadCard(index);
        }

        function loadCard(index) {
            currentDeckIndex = index;
            const dictIndex = deck[currentDeckIndex];
            const item = dictionary[dictIndex];

            // Reset UI karty
            isFlipped = false;
            cardElement.classList.remove('flipped');
            btnCor.style.display = 'none';
            btnInc.style.display = 'none';

            // Naplnenie textu
            if (currentMode === 'LAT_SK') {
                lblQuestion.textContent = "Latinsky";
                qContentEl.innerHTML = `<div class="card-content">${item.lat}</div>`;
                lblAnswer.textContent = "Slovensky";
                aContentEl.innerHTML = `<div class="card-content">${item.sk}</div>` + (item.def ? `<div class="def-text" style="font-size:1rem; margin-top:15px;">${item.def}</div>` : '');
            } else if (currentMode === 'SK_LAT') {
                lblQuestion.textContent = "Slovensky";
                qContentEl.innerHTML = `<div class="card-content">${item.sk}</div>`;
                lblAnswer.textContent = "Latinsky";
                aContentEl.innerHTML = `<div class="card-content">${item.lat}</div>`;
            } else if (currentMode === 'DEF_SK') {
                lblQuestion.textContent = "Definuj pojem:";
                qContentEl.innerHTML = `<div class="card-content">${item.sk}</div>`;
                lblAnswer.textContent = "Defin√≠cia";
                aContentEl.innerHTML = `<div class="def-text">${item.def}</div>`;
            } else if (currentMode === 'LAT_DEF') {
                lblQuestion.textContent = "Latinsky";
                qContentEl.innerHTML = `<div class="card-content">${item.lat}</div>`;
                lblAnswer.textContent = "Defin√≠cia";
                aContentEl.innerHTML = `<div class="def-text">${item.def}</div><div class="card-sub">(${item.sk})</div>`;
            } else if (currentMode === 'EXAM') {
                lblQuestion.textContent = "ƒåo je to? (Dopl≈à latinsk√Ω n√°zov)";
                qContentEl.innerHTML = `<div class="def-text">${item.def}</div>`;
                lblAnswer.textContent = "Latinsky";
                aContentEl.innerHTML = `<div class="card-content">${item.lat}</div><div class="card-sub">${item.sk}</div>`;
            }

            updateGrid();
            updateStats();
        }

        function updateStats() {
            const correct = sessionState.filter(s => s === 'correct').length;
            const incorrect = sessionState.filter(s => s === 'incorrect').length;
            
            document.getElementById('count-remaining').textContent = deck.length;
            document.getElementById('count-correct').textContent = correct;
            document.getElementById('count-incorrect').textContent = incorrect;
        }

        function flipCard() {
            isFlipped = !isFlipped;
            cardElement.classList.toggle('flipped');
            if (isFlipped) {
                btnCor.style.display = 'inline-block';
                btnInc.style.display = 'inline-block';
            } else {
                btnCor.style.display = 'none';
                btnInc.style.display = 'none';
            }
        }

        cardElement.addEventListener('click', (e) => {
            if (window.getSelection().toString().length === 0) flipCard();
        });

        function handleAnswer(isCorrect) {
            // Ulo≈æenie stavu
            sessionState[currentDeckIndex] = isCorrect ? 'correct' : 'incorrect';
            updateGrid();
            updateStats();

            // Logika posunu: N√°js≈• najbli≈æ≈°iu ƒèal≈°iu ot√°zku, ktor√° NIE JE "correct"
            // Najprv sk√∫sime od aktu√°lneho indexu + 1 po koniec
            let nextIndex = -1;
            
            // 1. Hƒæad√°me dopredu
            for (let i = currentDeckIndex + 1; i < deck.length; i++) {
                if (sessionState[i] !== 'correct') {
                    nextIndex = i;
                    break;
                }
            }

            // 2. Ak sme nena≈°li, hƒæad√°me od zaƒçiatku (wrap around)
            if (nextIndex === -1) {
                for (let i = 0; i < currentDeckIndex; i++) {
                    if (sessionState[i] !== 'correct') {
                        nextIndex = i;
                        break;
                    }
                }
            }

            // Ak st√°le -1, znamen√° to, ≈æe v≈°etko je correct okrem pr√°ve zodpovedanej (ak bola incorrect, ostane current)
            // Ak bola t√°to correct a nena≈°li sme in√∫, tak je koniec.
            
            if (sessionState.every(s => s === 'correct')) {
                finishGame();
            } else {
                if (nextIndex !== -1) {
                    loadCard(nextIndex);
                } else {
                    // Sme na poslednej zlej ot√°zke, osta≈à tu (refreshne sa cez loadCard pre vizu√°l)
                    loadCard(currentDeckIndex); 
                }
            }
        }

        function finishGame() {
            let msg = "V≈°etky slov√≠ƒçka √∫spe≈°ne prejden√©.";
            if (currentMode === 'EXAM') msg = "Sk√∫≈°ka dokonƒçen√°.";

            document.getElementById('card-container').innerHTML = `
                <div style="text-align:center; padding: 50px; background:white; border-radius:15px; box-shadow: 0 4px 15px rgba(0,0,0,0.1);">
                    <h1 style="color:#2ecc71; font-size: 3rem; margin-bottom:10px;">Hotovo!</h1>
                    <p style="font-size:1.2rem;">${msg}</p>
                    <button class="btn-menu" onclick="location.reload()">Sp√§≈• do menu</button>
                </div>
            `;
            document.getElementById('controls').style.display = 'none';
            document.getElementById('nav-grid').style.display = 'none';
        }

        // Init
        initSidebar();

    </script>
</body>
</html>